<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Day 5 | Biometrics II - STAT 341</title>
  <meta name="description" content="5 Day 5 | Biometrics II - STAT 341" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Day 5 | Biometrics II - STAT 341" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Day 5 | Biometrics II - STAT 341" />
  
  
  

<meta name="author" content="R. M. Sholl" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day-4.html"/>
<link rel="next" href="day-6.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 341</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="day-1.html"><a href="day-1.html"><i class="fa fa-check"></i><b>1</b> Day 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="day-1.html"><a href="day-1.html#welcome-mandatory-formalities"><i class="fa fa-check"></i><b>1.1</b> Welcome + Mandatory Formalities</a></li>
<li class="chapter" data-level="1.2" data-path="day-1.html"><a href="day-1.html#assignments"><i class="fa fa-check"></i><b>1.2</b> Assignments</a></li>
<li class="chapter" data-level="1.3" data-path="day-1.html"><a href="day-1.html#final-project"><i class="fa fa-check"></i><b>1.3</b> Final Project</a></li>
<li class="chapter" data-level="1.4" data-path="day-1.html"><a href="day-1.html#review"><i class="fa fa-check"></i><b>1.4</b> Review</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="day-1.html"><a href="day-1.html#general-intro-stats"><i class="fa fa-check"></i><b>1.4.1</b> General Intro Stats</a></li>
<li class="chapter" data-level="1.4.2" data-path="day-1.html"><a href="day-1.html#biometrics-i"><i class="fa fa-check"></i><b>1.4.2</b> Biometrics I</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="day-1.html"><a href="day-1.html#assignment-1"><i class="fa fa-check"></i><b>1.5</b> Assignment 1</a></li>
<li class="chapter" data-level="1.6" data-path="day-1.html"><a href="day-1.html#go-away"><i class="fa fa-check"></i><b>1.6</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-2.html"><a href="day-2.html"><i class="fa fa-check"></i><b>2</b> Day 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="day-2.html"><a href="day-2.html#math-overview"><i class="fa fa-check"></i><b>2.1</b> Math overview</a></li>
<li class="chapter" data-level="2.2" data-path="day-2.html"><a href="day-2.html#matrix-algebra"><i class="fa fa-check"></i><b>2.2</b> Matrix algebra</a></li>
<li class="chapter" data-level="2.3" data-path="day-2.html"><a href="day-2.html#calculus"><i class="fa fa-check"></i><b>2.3</b> Calculus</a></li>
<li class="chapter" data-level="2.4" data-path="day-2.html"><a href="day-2.html#advanced-math"><i class="fa fa-check"></i><b>2.4</b> Advanced Math</a></li>
<li class="chapter" data-level="2.5" data-path="day-2.html"><a href="day-2.html#next-class"><i class="fa fa-check"></i><b>2.5</b> Next class</a></li>
<li class="chapter" data-level="2.6" data-path="day-2.html"><a href="day-2.html#assignment-1-1"><i class="fa fa-check"></i><b>2.6</b> Assignment 1</a></li>
<li class="chapter" data-level="2.7" data-path="day-2.html"><a href="day-2.html#go-away-1"><i class="fa fa-check"></i><b>2.7</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-3.html"><a href="day-3.html"><i class="fa fa-check"></i><b>3</b> Day 3</a>
<ul>
<li class="chapter" data-level="3.1" data-path="day-3.html"><a href="day-3.html#review-1"><i class="fa fa-check"></i><b>3.1</b> Review</a></li>
<li class="chapter" data-level="3.2" data-path="day-3.html"><a href="day-3.html#r-programming"><i class="fa fa-check"></i><b>3.2</b> R Programming</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="day-3.html"><a href="day-3.html#r-studio"><i class="fa fa-check"></i><b>3.2.1</b> R Studio</a></li>
<li class="chapter" data-level="3.2.2" data-path="day-3.html"><a href="day-3.html#basic-principles"><i class="fa fa-check"></i><b>3.2.2</b> Basic principles</a></li>
<li class="chapter" data-level="3.2.3" data-path="day-3.html"><a href="day-3.html#live-example"><i class="fa fa-check"></i><b>3.2.3</b> Live example</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="day-3.html"><a href="day-3.html#r-programming-lab"><i class="fa fa-check"></i><b>3.3</b> R Programming Lab</a></li>
<li class="chapter" data-level="3.4" data-path="day-3.html"><a href="day-3.html#go-away-2"><i class="fa fa-check"></i><b>3.4</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-4.html"><a href="day-4.html"><i class="fa fa-check"></i><b>4</b> Day 4</a>
<ul>
<li class="chapter" data-level="4.1" data-path="day-4.html"><a href="day-4.html#review-2"><i class="fa fa-check"></i><b>4.1</b> Review</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="day-4.html"><a href="day-4.html#basic-principles-1"><i class="fa fa-check"></i><b>4.1.1</b> Basic principles</a></li>
<li class="chapter" data-level="4.1.2" data-path="day-4.html"><a href="day-4.html#r-basics"><i class="fa fa-check"></i><b>4.1.2</b> R Basics</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="day-4.html"><a href="day-4.html#more-advanced-stuff"><i class="fa fa-check"></i><b>4.2</b> (More) Advanced stuff</a></li>
<li class="chapter" data-level="4.3" data-path="day-4.html"><a href="day-4.html#advanced-programming"><i class="fa fa-check"></i><b>4.3</b> Advanced Programming</a></li>
<li class="chapter" data-level="4.4" data-path="day-4.html"><a href="day-4.html#in-class-activity"><i class="fa fa-check"></i><b>4.4</b> In-class activity</a></li>
<li class="chapter" data-level="4.5" data-path="day-4.html"><a href="day-4.html#go-away-3"><i class="fa fa-check"></i><b>4.5</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day-5.html"><a href="day-5.html"><i class="fa fa-check"></i><b>5</b> Day 5</a>
<ul>
<li class="chapter" data-level="5.1" data-path="day-5.html"><a href="day-5.html#review-3"><i class="fa fa-check"></i><b>5.1</b> Review</a></li>
<li class="chapter" data-level="5.2" data-path="day-5.html"><a href="day-5.html#statistical-modeling"><i class="fa fa-check"></i><b>5.2</b> Statistical Modeling</a></li>
<li class="chapter" data-level="5.3" data-path="day-5.html"><a href="day-5.html#stringing-sentences"><i class="fa fa-check"></i><b>5.3</b> Stringing sentences</a></li>
<li class="chapter" data-level="5.4" data-path="day-5.html"><a href="day-5.html#telling-stories"><i class="fa fa-check"></i><b>5.4</b> Telling stories</a></li>
<li class="chapter" data-level="5.5" data-path="day-5.html"><a href="day-5.html#go-away-4"><i class="fa fa-check"></i><b>5.5</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day-6.html"><a href="day-6.html"><i class="fa fa-check"></i><b>6</b> Day 6</a>
<ul>
<li class="chapter" data-level="6.1" data-path="day-6.html"><a href="day-6.html#review-4"><i class="fa fa-check"></i><b>6.1</b> Review</a></li>
<li class="chapter" data-level="6.2" data-path="day-6.html"><a href="day-6.html#stringing-sentences-1"><i class="fa fa-check"></i><b>6.2</b> Stringing sentences</a></li>
<li class="chapter" data-level="6.3" data-path="day-6.html"><a href="day-6.html#telling-stories-1"><i class="fa fa-check"></i><b>6.3</b> Telling stories</a></li>
<li class="chapter" data-level="6.4" data-path="day-6.html"><a href="day-6.html#linear-models"><i class="fa fa-check"></i><b>6.4</b> Linear models</a></li>
<li class="chapter" data-level="6.5" data-path="day-6.html"><a href="day-6.html#parameter-estimation"><i class="fa fa-check"></i><b>6.5</b> Parameter estimation</a></li>
<li class="chapter" data-level="6.6" data-path="day-6.html"><a href="day-6.html#live-example-1"><i class="fa fa-check"></i><b>6.6</b> Live example</a></li>
<li class="chapter" data-level="6.7" data-path="day-6.html"><a href="day-6.html#the-path-forward"><i class="fa fa-check"></i><b>6.7</b> The path forward</a></li>
<li class="chapter" data-level="6.8" data-path="day-6.html"><a href="day-6.html#go-away-5"><i class="fa fa-check"></i><b>6.8</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="day-7.html"><a href="day-7.html"><i class="fa fa-check"></i><b>7</b> Day 7</a>
<ul>
<li class="chapter" data-level="7.1" data-path="day-7.html"><a href="day-7.html#review-5"><i class="fa fa-check"></i><b>7.1</b> Review</a></li>
<li class="chapter" data-level="7.2" data-path="day-7.html"><a href="day-7.html#multivariate-normal-distributions"><i class="fa fa-check"></i><b>7.2</b> Multivariate Normal Distributions</a></li>
<li class="chapter" data-level="7.3" data-path="day-7.html"><a href="day-7.html#the-simplest-model"><i class="fa fa-check"></i><b>7.3</b> The simplest model</a></li>
<li class="chapter" data-level="7.4" data-path="day-7.html"><a href="day-7.html#live-example-2"><i class="fa fa-check"></i><b>7.4</b> Live example</a></li>
<li class="chapter" data-level="7.5" data-path="day-7.html"><a href="day-7.html#go-away-6"><i class="fa fa-check"></i><b>7.5</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="day-8.html"><a href="day-8.html"><i class="fa fa-check"></i><b>8</b> Day 8</a>
<ul>
<li class="chapter" data-level="8.1" data-path="day-8.html"><a href="day-8.html#review-6"><i class="fa fa-check"></i><b>8.1</b> Review</a></li>
<li class="chapter" data-level="8.2" data-path="day-8.html"><a href="day-8.html#adding-complexity"><i class="fa fa-check"></i><b>8.2</b> Adding complexity</a></li>
<li class="chapter" data-level="8.3" data-path="day-8.html"><a href="day-8.html#model-development"><i class="fa fa-check"></i><b>8.3</b> Model development</a></li>
<li class="chapter" data-level="8.4" data-path="day-8.html"><a href="day-8.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a></li>
<li class="chapter" data-level="8.5" data-path="day-8.html"><a href="day-8.html#derived-quantities"><i class="fa fa-check"></i><b>8.5</b> Derived quantities</a></li>
<li class="chapter" data-level="8.6" data-path="day-8.html"><a href="day-8.html#r-programming-lab-1"><i class="fa fa-check"></i><b>8.6</b> R programming Lab</a></li>
<li class="chapter" data-level="8.7" data-path="day-8.html"><a href="day-8.html#go-away-7"><i class="fa fa-check"></i><b>8.7</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="day-9.html"><a href="day-9.html"><i class="fa fa-check"></i><b>9</b> Day 9</a>
<ul>
<li class="chapter" data-level="9.1" data-path="day-9.html"><a href="day-9.html#review-7"><i class="fa fa-check"></i><b>9.1</b> Review</a></li>
<li class="chapter" data-level="9.2" data-path="day-9.html"><a href="day-9.html#confidence-intervals-for-derived-quantities"><i class="fa fa-check"></i><b>9.2</b> Confidence intervals for derived quantities</a></li>
<li class="chapter" data-level="9.3" data-path="day-9.html"><a href="day-9.html#non-parametric-bootstrap"><i class="fa fa-check"></i><b>9.3</b> Non-parametric bootstrap</a></li>
<li class="chapter" data-level="9.4" data-path="day-9.html"><a href="day-9.html#concept-demo"><i class="fa fa-check"></i><b>9.4</b> Concept demo</a></li>
<li class="chapter" data-level="9.5" data-path="day-9.html"><a href="day-9.html#r-programming-lab-2"><i class="fa fa-check"></i><b>9.5</b> R programming Lab</a></li>
<li class="chapter" data-level="9.6" data-path="day-9.html"><a href="day-9.html#go-away-8"><i class="fa fa-check"></i><b>9.6</b> Go away</a></li>
<li class="chapter" data-level="9.7" data-path="day-9.html"><a href="day-9.html#extended-notes-on-the-delta-method"><i class="fa fa-check"></i><b>9.7</b> Extended notes on the Delta Method</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="day-10.html"><a href="day-10.html"><i class="fa fa-check"></i><b>10</b> Day 10</a>
<ul>
<li class="chapter" data-level="10.1" data-path="day-10.html"><a href="day-10.html#review-8"><i class="fa fa-check"></i><b>10.1</b> Review</a></li>
<li class="chapter" data-level="10.2" data-path="day-10.html"><a href="day-10.html#in-class-activity-1"><i class="fa fa-check"></i><b>10.2</b> In-class activity</a></li>
<li class="chapter" data-level="10.3" data-path="day-10.html"><a href="day-10.html#assignment-3"><i class="fa fa-check"></i><b>10.3</b> Assignment 3</a></li>
<li class="chapter" data-level="10.4" data-path="day-10.html"><a href="day-10.html#projects"><i class="fa fa-check"></i><b>10.4</b> Projects</a></li>
<li class="chapter" data-level="10.5" data-path="day-10.html"><a href="day-10.html#class-choice-lectures"><i class="fa fa-check"></i><b>10.5</b> Class choice lectures</a></li>
<li class="chapter" data-level="10.6" data-path="day-10.html"><a href="day-10.html#go-away-9"><i class="fa fa-check"></i><b>10.6</b> Go away</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assignment-1-2.html"><a href="assignment-1-2.html"><i class="fa fa-check"></i><b>11</b> Assignment 1</a></li>
<li class="chapter" data-level="12" data-path="assignment-2.html"><a href="assignment-2.html"><i class="fa fa-check"></i><b>12</b> Assignment 2</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biometrics II - STAT 341</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day-5" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Day 5<a href="day-5.html#day-5" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="review-3" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Review<a href="day-5.html#review-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Documentation/commenting code</li>
</ul>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="day-5.html#cb199-1" tabindex="-1"></a><span class="co"># mtcars base R dataset</span></span>
<span id="cb199-2"><a href="day-5.html#cb199-2" tabindex="-1"></a>data <span class="ot">=</span> mtcars</span>
<span id="cb199-3"><a href="day-5.html#cb199-3" tabindex="-1"></a></span>
<span id="cb199-4"><a href="day-5.html#cb199-4" tabindex="-1"></a>y <span class="ot">=</span> data<span class="sc">$</span>mpg <span class="co"># mpg</span></span>
<span id="cb199-5"><a href="day-5.html#cb199-5" tabindex="-1"></a>x1 <span class="ot">=</span> data<span class="sc">$</span>hp <span class="co"># horsepower </span></span>
<span id="cb199-6"><a href="day-5.html#cb199-6" tabindex="-1"></a>x2 <span class="ot">=</span> data<span class="sc">$</span>wt <span class="co"># weight</span></span>
<span id="cb199-7"><a href="day-5.html#cb199-7" tabindex="-1"></a></span>
<span id="cb199-8"><a href="day-5.html#cb199-8" tabindex="-1"></a><span class="co"># linear model predicting mpg with horsepower</span></span>
<span id="cb199-9"><a href="day-5.html#cb199-9" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1)</span>
<span id="cb199-10"><a href="day-5.html#cb199-10" tabindex="-1"></a></span>
<span id="cb199-11"><a href="day-5.html#cb199-11" tabindex="-1"></a><span class="co"># predict mpg with weight</span></span>
<span id="cb199-12"><a href="day-5.html#cb199-12" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x2)</span>
<span id="cb199-13"><a href="day-5.html#cb199-13" tabindex="-1"></a></span>
<span id="cb199-14"><a href="day-5.html#cb199-14" tabindex="-1"></a><span class="co"># predict mpg with both</span></span>
<span id="cb199-15"><a href="day-5.html#cb199-15" tabindex="-1"></a>m3 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb199-16"><a href="day-5.html#cb199-16" tabindex="-1"></a></span>
<span id="cb199-17"><a href="day-5.html#cb199-17" tabindex="-1"></a><span class="co"># coefficients for each model</span></span>
<span id="cb199-18"><a href="day-5.html#cb199-18" tabindex="-1"></a><span class="fu">coef</span>(m1)</span>
<span id="cb199-19"><a href="day-5.html#cb199-19" tabindex="-1"></a><span class="fu">coef</span>(m2)</span>
<span id="cb199-20"><a href="day-5.html#cb199-20" tabindex="-1"></a><span class="fu">coef</span>(m3)</span></code></pre></div>
<ul>
<li>Helper functions</li>
</ul>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="day-5.html#cb200-1" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># tidyverse data wrangling</span></span>
<span id="cb200-2"><a href="day-5.html#cb200-2" tabindex="-1"></a></span>
<span id="cb200-3"><a href="day-5.html#cb200-3" tabindex="-1"></a><span class="co"># function to calculate means for x based on strata</span></span>
<span id="cb200-4"><a href="day-5.html#cb200-4" tabindex="-1"></a>strata_means <span class="ot">=</span> <span class="cf">function</span>(data,strata,x){</span>
<span id="cb200-5"><a href="day-5.html#cb200-5" tabindex="-1"></a>  out <span class="ot">=</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb200-6"><a href="day-5.html#cb200-6" tabindex="-1"></a>    <span class="co"># group by strata</span></span>
<span id="cb200-7"><a href="day-5.html#cb200-7" tabindex="-1"></a>    <span class="fu">group_by</span>(.data[[strata]]) <span class="sc">%&gt;%</span></span>
<span id="cb200-8"><a href="day-5.html#cb200-8" tabindex="-1"></a>    <span class="co"># calculate mean of x per strata</span></span>
<span id="cb200-9"><a href="day-5.html#cb200-9" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">xbar =</span> <span class="fu">mean</span>(.data[[x]]))</span>
<span id="cb200-10"><a href="day-5.html#cb200-10" tabindex="-1"></a>  <span class="co"># rename columns</span></span>
<span id="cb200-11"><a href="day-5.html#cb200-11" tabindex="-1"></a>  <span class="fu">colnames</span>(out) <span class="ot">=</span> <span class="fu">c</span>(strata,x)</span>
<span id="cb200-12"><a href="day-5.html#cb200-12" tabindex="-1"></a>  <span class="fu">return</span>(out) <span class="co"># return dataframe of means</span></span>
<span id="cb200-13"><a href="day-5.html#cb200-13" tabindex="-1"></a>}</span>
<span id="cb200-14"><a href="day-5.html#cb200-14" tabindex="-1"></a></span>
<span id="cb200-15"><a href="day-5.html#cb200-15" tabindex="-1"></a><span class="co"># run function</span></span>
<span id="cb200-16"><a href="day-5.html#cb200-16" tabindex="-1"></a><span class="fu">strata_means</span>(data,<span class="st">&quot;vs&quot;</span>,<span class="st">&quot;mpg&quot;</span>)</span></code></pre></div>
<p><br></p>
<ul>
<li><p>Explanatory code</p>
<ul>
<li>Objects/elements/function are named in ways that don’t require comments</li>
</ul></li>
<li><p>Naming conventions</p>
<ul>
<li><p>camelCase</p></li>
<li><p>snake_case</p></li>
<li><p>PascalCase</p></li>
<li><p>kebab-case</p></li>
<li><p>UPPER_CASE</p></li>
<li><p>S.case (common in R)</p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>Error catching</li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="day-5.html#cb201-1" tabindex="-1"></a><span class="co"># function to calculate means for x based on strata</span></span>
<span id="cb201-2"><a href="day-5.html#cb201-2" tabindex="-1"></a>strata_means <span class="ot">=</span> <span class="cf">function</span>(data,strata,x){</span>
<span id="cb201-3"><a href="day-5.html#cb201-3" tabindex="-1"></a>  </span>
<span id="cb201-4"><a href="day-5.html#cb201-4" tabindex="-1"></a>  <span class="co"># error catch for non-numeric inputs</span></span>
<span id="cb201-5"><a href="day-5.html#cb201-5" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(data[[x]]) <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb201-6"><a href="day-5.html#cb201-6" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Error: Variable input to be averaged is non-numeric.&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb201-7"><a href="day-5.html#cb201-7" tabindex="-1"></a>        <span class="st">&quot;Please check str(data[[x]]) and confirm.&quot;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb201-8"><a href="day-5.html#cb201-8" tabindex="-1"></a>        <span class="st">&quot;Change to as.numeric(data[[x]]) if this is intended.&quot;</span>)</span>
<span id="cb201-9"><a href="day-5.html#cb201-9" tabindex="-1"></a>  }</span>
<span id="cb201-10"><a href="day-5.html#cb201-10" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb201-11"><a href="day-5.html#cb201-11" tabindex="-1"></a>    out <span class="ot">=</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb201-12"><a href="day-5.html#cb201-12" tabindex="-1"></a>      <span class="co"># group by strata</span></span>
<span id="cb201-13"><a href="day-5.html#cb201-13" tabindex="-1"></a>      <span class="fu">group_by</span>(.data[[strata]]) <span class="sc">%&gt;%</span></span>
<span id="cb201-14"><a href="day-5.html#cb201-14" tabindex="-1"></a>      <span class="co"># calculate mean of x per strata</span></span>
<span id="cb201-15"><a href="day-5.html#cb201-15" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">xbar =</span> <span class="fu">mean</span>(.data[[x]]))</span>
<span id="cb201-16"><a href="day-5.html#cb201-16" tabindex="-1"></a>    <span class="co"># rename columns</span></span>
<span id="cb201-17"><a href="day-5.html#cb201-17" tabindex="-1"></a>    <span class="fu">colnames</span>(out) <span class="ot">=</span> <span class="fu">c</span>(strata,x)</span>
<span id="cb201-18"><a href="day-5.html#cb201-18" tabindex="-1"></a>    <span class="fu">return</span>(out) <span class="co"># return dataframe of means</span></span>
<span id="cb201-19"><a href="day-5.html#cb201-19" tabindex="-1"></a>  }</span>
<span id="cb201-20"><a href="day-5.html#cb201-20" tabindex="-1"></a>}</span>
<span id="cb201-21"><a href="day-5.html#cb201-21" tabindex="-1"></a></span>
<span id="cb201-22"><a href="day-5.html#cb201-22" tabindex="-1"></a><span class="co"># run function</span></span>
<span id="cb201-23"><a href="day-5.html#cb201-23" tabindex="-1"></a>data<span class="sc">$</span>mpg <span class="ot">=</span> <span class="fu">as.character</span>(data<span class="sc">$</span>mpg)</span>
<span id="cb201-24"><a href="day-5.html#cb201-24" tabindex="-1"></a><span class="fu">strata_means</span>(data,<span class="st">&quot;vs&quot;</span>,<span class="st">&quot;mpg&quot;</span>)</span></code></pre></div>
<pre><code>## Error: Variable input to be averaged is non-numeric. 
##  Please check str(data[[x]]) and confirm. 
##  Change to as.numeric(data[[x]]) if this is intended.</code></pre>
<ul>
<li>Data types</li>
</ul>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="day-5.html#cb203-1" tabindex="-1"></a><span class="co"># scalars/variables</span></span>
<span id="cb203-2"><a href="day-5.html#cb203-2" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb203-3"><a href="day-5.html#cb203-3" tabindex="-1"></a>a</span>
<span id="cb203-4"><a href="day-5.html#cb203-4" tabindex="-1"></a></span>
<span id="cb203-5"><a href="day-5.html#cb203-5" tabindex="-1"></a><span class="co"># vectors</span></span>
<span id="cb203-6"><a href="day-5.html#cb203-6" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb203-7"><a href="day-5.html#cb203-7" tabindex="-1"></a>x</span>
<span id="cb203-8"><a href="day-5.html#cb203-8" tabindex="-1"></a></span>
<span id="cb203-9"><a href="day-5.html#cb203-9" tabindex="-1"></a><span class="co"># matrices</span></span>
<span id="cb203-10"><a href="day-5.html#cb203-10" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x,x<span class="dv">-1</span>,x<span class="sc">+</span><span class="dv">3</span>),<span class="dv">3</span>,<span class="dv">3</span>,T)</span>
<span id="cb203-11"><a href="day-5.html#cb203-11" tabindex="-1"></a>A</span>
<span id="cb203-12"><a href="day-5.html#cb203-12" tabindex="-1"></a></span>
<span id="cb203-13"><a href="day-5.html#cb203-13" tabindex="-1"></a><span class="co"># data frame</span></span>
<span id="cb203-14"><a href="day-5.html#cb203-14" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">fruit =</span> <span class="fu">c</span>(<span class="st">&quot;Apple&quot;</span>, <span class="st">&quot;Banana&quot;</span>, <span class="st">&quot;Orange&quot;</span>),</span>
<span id="cb203-15"><a href="day-5.html#cb203-15" tabindex="-1"></a>                <span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">111</span>,<span class="dv">112</span>,<span class="dv">113</span>),</span>
<span id="cb203-16"><a href="day-5.html#cb203-16" tabindex="-1"></a>                <span class="at">Count =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">12</span>,<span class="dv">2</span>))</span>
<span id="cb203-17"><a href="day-5.html#cb203-17" tabindex="-1"></a>df</span>
<span id="cb203-18"><a href="day-5.html#cb203-18" tabindex="-1"></a></span>
<span id="cb203-19"><a href="day-5.html#cb203-19" tabindex="-1"></a><span class="co"># list</span></span>
<span id="cb203-20"><a href="day-5.html#cb203-20" tabindex="-1"></a>ls <span class="ot">=</span> <span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">A =</span> A, <span class="at">df =</span> df)</span>
<span id="cb203-21"><a href="day-5.html#cb203-21" tabindex="-1"></a>ls</span></code></pre></div>
<ul>
<li>Data elements</li>
</ul>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="day-5.html#cb204-1" tabindex="-1"></a><span class="co"># access vector elements by position</span></span>
<span id="cb204-2"><a href="day-5.html#cb204-2" tabindex="-1"></a>x[<span class="dv">1</span>]</span>
<span id="cb204-3"><a href="day-5.html#cb204-3" tabindex="-1"></a>x[<span class="dv">3</span>]</span>
<span id="cb204-4"><a href="day-5.html#cb204-4" tabindex="-1"></a></span>
<span id="cb204-5"><a href="day-5.html#cb204-5" tabindex="-1"></a><span class="co"># matrix elements: [row,column]</span></span>
<span id="cb204-6"><a href="day-5.html#cb204-6" tabindex="-1"></a>A</span>
<span id="cb204-7"><a href="day-5.html#cb204-7" tabindex="-1"></a>A[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb204-8"><a href="day-5.html#cb204-8" tabindex="-1"></a></span>
<span id="cb204-9"><a href="day-5.html#cb204-9" tabindex="-1"></a><span class="co"># dataframe$column or dataframe[[&quot;column&quot;]]</span></span>
<span id="cb204-10"><a href="day-5.html#cb204-10" tabindex="-1"></a>df<span class="sc">$</span>fruit</span>
<span id="cb204-11"><a href="day-5.html#cb204-11" tabindex="-1"></a>df[[<span class="st">&quot;fruit&quot;</span>]]</span>
<span id="cb204-12"><a href="day-5.html#cb204-12" tabindex="-1"></a></span>
<span id="cb204-13"><a href="day-5.html#cb204-13" tabindex="-1"></a><span class="co"># list[[element]]</span></span>
<span id="cb204-14"><a href="day-5.html#cb204-14" tabindex="-1"></a>ls[[<span class="dv">2</span>]]</span>
<span id="cb204-15"><a href="day-5.html#cb204-15" tabindex="-1"></a>ls[[<span class="dv">2</span>]][<span class="dv">3</span>,<span class="dv">1</span>]</span></code></pre></div>
<ul>
<li>Data actions</li>
</ul>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="day-5.html#cb205-1" tabindex="-1"></a><span class="co"># change the elements of a dataframe column</span></span>
<span id="cb205-2"><a href="day-5.html#cb205-2" tabindex="-1"></a>df<span class="sc">$</span>ID <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb205-3"><a href="day-5.html#cb205-3" tabindex="-1"></a>df<span class="sc">$</span>ID</span>
<span id="cb205-4"><a href="day-5.html#cb205-4" tabindex="-1"></a></span>
<span id="cb205-5"><a href="day-5.html#cb205-5" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;R1&quot;</span>,<span class="st">&quot;R2&quot;</span>,<span class="st">&quot;R3&quot;</span>) <span class="co"># rename rows</span></span>
<span id="cb205-6"><a href="day-5.html#cb205-6" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;C1&quot;</span>,<span class="st">&quot;C2&quot;</span>,<span class="st">&quot;C3&quot;</span>) <span class="co"># rename columns</span></span>
<span id="cb205-7"><a href="day-5.html#cb205-7" tabindex="-1"></a>df</span></code></pre></div>
<ul>
<li>Booleans</li>
</ul>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="day-5.html#cb206-1" tabindex="-1"></a>df<span class="sc">$</span>C1</span>
<span id="cb206-2"><a href="day-5.html#cb206-2" tabindex="-1"></a>df<span class="sc">$</span>C1 <span class="sc">==</span> <span class="st">&quot;Apple&quot;</span> <span class="co"># print true where apple is present</span></span>
<span id="cb206-3"><a href="day-5.html#cb206-3" tabindex="-1"></a>df<span class="sc">$</span>C1 <span class="sc">!=</span> <span class="st">&quot;Apple&quot;</span> <span class="co"># print true when not apple</span></span></code></pre></div>
<ul>
<li>Extended print statements</li>
</ul>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="day-5.html#cb207-1" tabindex="-1"></a><span class="co"># single line</span></span>
<span id="cb207-2"><a href="day-5.html#cb207-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The mean of column 3 is:&quot;</span>, <span class="fu">mean</span>(df<span class="sc">$</span>C3), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb207-3"><a href="day-5.html#cb207-3" tabindex="-1"></a></span>
<span id="cb207-4"><a href="day-5.html#cb207-4" tabindex="-1"></a><span class="co"># multiple lines using &quot;\n&quot; for breaks</span></span>
<span id="cb207-5"><a href="day-5.html#cb207-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The variance of column 3 is:&quot;</span>, <span class="fu">var</span>(df<span class="sc">$</span>C3), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb207-6"><a href="day-5.html#cb207-6" tabindex="-1"></a>    <span class="st">&quot;The standard deviation of column 3 is:&quot;</span>, <span class="fu">sd</span>(df<span class="sc">$</span>C3))</span></code></pre></div>
<ul>
<li>Removing NA values</li>
</ul>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="day-5.html#cb208-1" tabindex="-1"></a>df[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb208-2"><a href="day-5.html#cb208-2" tabindex="-1"></a><span class="fu">na.omit</span>(df) <span class="co"># removes all rows with NAs</span></span>
<span id="cb208-3"><a href="day-5.html#cb208-3" tabindex="-1"></a>df[,<span class="fu">colSums</span>(<span class="fu">is.na</span>(df)) <span class="sc">==</span> <span class="dv">0</span>] <span class="co"># remove all columns with NAs</span></span></code></pre></div>
<ul>
<li>Replacing NA values</li>
</ul>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="day-5.html#cb209-1" tabindex="-1"></a>df[<span class="fu">is.na</span>(df)] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb209-2"><a href="day-5.html#cb209-2" tabindex="-1"></a>df</span></code></pre></div>
<p><br></p>
<ul>
<li>For loops (Note on C programming)</li>
</ul>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="day-5.html#cb210-1" tabindex="-1"></a><span class="co"># mtcars data</span></span>
<span id="cb210-2"><a href="day-5.html#cb210-2" tabindex="-1"></a>data <span class="ot">=</span> mtcars</span>
<span id="cb210-3"><a href="day-5.html#cb210-3" tabindex="-1"></a><span class="co"># split by vs</span></span>
<span id="cb210-4"><a href="day-5.html#cb210-4" tabindex="-1"></a>splt <span class="ot">=</span> <span class="fu">split</span>(mtcars,mtcars<span class="sc">$</span>vs)</span>
<span id="cb210-5"><a href="day-5.html#cb210-5" tabindex="-1"></a><span class="co"># empty vector</span></span>
<span id="cb210-6"><a href="day-5.html#cb210-6" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb210-7"><a href="day-5.html#cb210-7" tabindex="-1"></a></span>
<span id="cb210-8"><a href="day-5.html#cb210-8" tabindex="-1"></a><span class="co"># &quot;for each element of the list&quot;</span></span>
<span id="cb210-9"><a href="day-5.html#cb210-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(splt)){</span>
<span id="cb210-10"><a href="day-5.html#cb210-10" tabindex="-1"></a>  <span class="co"># fill the vector with the mean mpg</span></span>
<span id="cb210-11"><a href="day-5.html#cb210-11" tabindex="-1"></a>  <span class="co"># of each list element</span></span>
<span id="cb210-12"><a href="day-5.html#cb210-12" tabindex="-1"></a>  out[i] <span class="ot">=</span> <span class="fu">mean</span>(splt[[i]]<span class="sc">$</span>mpg)</span>
<span id="cb210-13"><a href="day-5.html#cb210-13" tabindex="-1"></a>}</span>
<span id="cb210-14"><a href="day-5.html#cb210-14" tabindex="-1"></a></span>
<span id="cb210-15"><a href="day-5.html#cb210-15" tabindex="-1"></a>out <span class="co"># matches the strata_means() output</span></span></code></pre></div>
<p><br></p>
<ul>
<li>Concatenate</li>
</ul>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="day-5.html#cb211-1" tabindex="-1"></a><span class="co"># a way to push extended strings onto objects</span></span>
<span id="cb211-2"><a href="day-5.html#cb211-2" tabindex="-1"></a><span class="fu">names</span>(out) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;vs = &quot;</span>, <span class="fu">names</span>(splt), <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb211-3"><a href="day-5.html#cb211-3" tabindex="-1"></a></span>
<span id="cb211-4"><a href="day-5.html#cb211-4" tabindex="-1"></a>out <span class="co"># labels better match strata_means()</span></span></code></pre></div>
<p><br></p>
<ul>
<li>Libraries/packages</li>
</ul>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="day-5.html#cb212-1" tabindex="-1"></a><span class="co"># install.packages(&quot;dplyr&quot;)</span></span>
<span id="cb212-2"><a href="day-5.html#cb212-2" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># we&#39;ve seen this a lot</span></span>
<span id="cb212-3"><a href="day-5.html#cb212-3" tabindex="-1"></a></span>
<span id="cb212-4"><a href="day-5.html#cb212-4" tabindex="-1"></a><span class="co"># install.packages(&quot;readxl&quot;)</span></span>
<span id="cb212-5"><a href="day-5.html#cb212-5" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># excel files can&#39;t be read by default in R</span></span>
<span id="cb212-6"><a href="day-5.html#cb212-6" tabindex="-1"></a></span>
<span id="cb212-7"><a href="day-5.html#cb212-7" tabindex="-1"></a><span class="co"># install.packages(&quot;nlme&quot;)</span></span>
<span id="cb212-8"><a href="day-5.html#cb212-8" tabindex="-1"></a><span class="fu">library</span>(nlme) <span class="co"># generalized least squares</span></span>
<span id="cb212-9"><a href="day-5.html#cb212-9" tabindex="-1"></a>              <span class="co"># important for next week</span></span></code></pre></div>
<p><br></p>
<ul>
<li><p>R Markdown</p>
<ul>
<li><p>“Graves” ” ` ”</p></li>
<li><p>{r}, {r, echo=FALSE, message=FALSE, warning=FALSE}</p></li>
<li><p>{fig.align=‘center’}</p></li>
<li><p>HTML vs PDF</p></li>
<li><p>Headers</p></li>
</ul></li>
</ul>
<p><br></p>
<pre><code># First level

## Second level

### Third level

- Bullet

* Bullet

+ Bullet

1. Numbered bullet

a. Letter bullet

&gt; Quote block</code></pre>
<ul>
<li>Quarto vs. Rmd</li>
</ul>
<p><br></p>
<ul>
<li><p>LaTeX</p>
<ul>
<li><p><code>$</code> vs <code>$$</code> vs <code>\[</code></p></li>
<li><p><code>\beta</code>, <code>\gamma</code></p></li>
<li><p><code>\bar{}</code>, <code>\hat{}</code></p></li>
<li><p><code>\begin{array}</code>, <code>\begin{bmatrix}</code>, <code>\begin{aligned}</code></p></li>
<li><p><code>\vspace{3mm}</code>, <code>\newpage</code></p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li>Mean and standard deviation</li>
</ul>
<p><span class="math display">\[
\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i
\qquad\qquad
s = \sqrt{s^2} = \sqrt{\frac{1}{n-1} \sum_{i=1}(x_i - \bar{x})^2}
\]</span></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="day-5.html#cb214-1" tabindex="-1"></a><span class="co"># base R dataset on fiji earthquakes</span></span>
<span id="cb214-2"><a href="day-5.html#cb214-2" tabindex="-1"></a>quakes <span class="ot">=</span> datasets<span class="sc">::</span>quakes</span>
<span id="cb214-3"><a href="day-5.html#cb214-3" tabindex="-1"></a></span>
<span id="cb214-4"><a href="day-5.html#cb214-4" tabindex="-1"></a><span class="co"># mean magnitude</span></span>
<span id="cb214-5"><a href="day-5.html#cb214-5" tabindex="-1"></a><span class="fu">mean</span>(quakes<span class="sc">$</span>mag)</span></code></pre></div>
<pre><code>## [1] 4.6204</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="day-5.html#cb216-1" tabindex="-1"></a><span class="co"># variance of magnitude</span></span>
<span id="cb216-2"><a href="day-5.html#cb216-2" tabindex="-1"></a><span class="fu">var</span>(quakes<span class="sc">$</span>mag)</span></code></pre></div>
<pre><code>## [1] 0.1622261</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="day-5.html#cb218-1" tabindex="-1"></a><span class="co"># standard deviation of magnitude</span></span>
<span id="cb218-2"><a href="day-5.html#cb218-2" tabindex="-1"></a><span class="fu">sd</span>(quakes<span class="sc">$</span>mag)</span></code></pre></div>
<pre><code>## [1] 0.402773</code></pre>
<ul>
<li>Quantiles/Quartiles</li>
</ul>
<p><span class="math display">\[
\begin{array}{|c|c|c|c|c|}
\hline
\text{Min} &amp; \text{Q}_1 &amp; \text{Median} &amp; \text{Q}_3 &amp; \text{Max} \\
\hline
0^{th} &amp; 25^{th} &amp; 50^{th} &amp; 75^{th} &amp; 100^{th} \\
\hline
\end{array}
\]</span></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="day-5.html#cb220-1" tabindex="-1"></a><span class="co"># five number summary as quantiles</span></span>
<span id="cb220-2"><a href="day-5.html#cb220-2" tabindex="-1"></a><span class="fu">quantile</span>(quakes<span class="sc">$</span>mag, <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##  4.0  4.3  4.6  4.9  6.4</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="day-5.html#cb222-1" tabindex="-1"></a><span class="co"># five number summary base R function</span></span>
<span id="cb222-2"><a href="day-5.html#cb222-2" tabindex="-1"></a><span class="fu">fivenum</span>(quakes<span class="sc">$</span>mag)</span></code></pre></div>
<pre><code>## [1] 4.0 4.3 4.6 4.9 6.4</code></pre>
<ul>
<li>Histograms and Boxplots</li>
</ul>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="day-5.html#cb224-1" tabindex="-1"></a><span class="co"># base R histogram</span></span>
<span id="cb224-2"><a href="day-5.html#cb224-2" tabindex="-1"></a><span class="fu">hist</span>(quakes<span class="sc">$</span>mag,</span>
<span id="cb224-3"><a href="day-5.html#cb224-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Magnitude&quot;</span>, <span class="co"># x axis label</span></span>
<span id="cb224-4"><a href="day-5.html#cb224-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Earthquakes off Fiji&quot;</span>, <span class="co"># title</span></span>
<span id="cb224-5"><a href="day-5.html#cb224-5" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># bar color</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="day-5.html#cb225-1" tabindex="-1"></a><span class="fu">hist</span>(quakes<span class="sc">$</span>mag, <span class="co"># data</span></span>
<span id="cb225-2"><a href="day-5.html#cb225-2" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Magnitude&quot;</span>,</span>
<span id="cb225-3"><a href="day-5.html#cb225-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Earthquakes off Fiji&quot;</span>,</span>
<span id="cb225-4"><a href="day-5.html#cb225-4" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb225-5"><a href="day-5.html#cb225-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(quakes<span class="sc">$</span>mag), <span class="co"># vertical mean line</span></span>
<span id="cb225-6"><a href="day-5.html#cb225-6" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span>, <span class="co"># line type (dashed)</span></span>
<span id="cb225-7"><a href="day-5.html#cb225-7" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="co"># line width</span></span>
<span id="cb225-8"><a href="day-5.html#cb225-8" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;gold&quot;</span>) <span class="co"># line color</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="day-5.html#cb226-1" tabindex="-1"></a><span class="co"># margin control</span></span>
<span id="cb226-2"><a href="day-5.html#cb226-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># bottom, left, top, right</span></span>
<span id="cb226-3"><a href="day-5.html#cb226-3" tabindex="-1"></a><span class="co"># base R boxplot</span></span>
<span id="cb226-4"><a href="day-5.html#cb226-4" tabindex="-1"></a><span class="fu">boxplot</span>(quakes<span class="sc">$</span>mag,</span>
<span id="cb226-5"><a href="day-5.html#cb226-5" tabindex="-1"></a>        <span class="at">horizontal =</span> T, <span class="co"># set as horizontal (T = TRUE)</span></span>
<span id="cb226-6"><a href="day-5.html#cb226-6" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># central box color</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="day-5.html#cb227-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb227-2"><a href="day-5.html#cb227-2" tabindex="-1"></a><span class="fu">boxplot</span>(quakes<span class="sc">$</span>mag,</span>
<span id="cb227-3"><a href="day-5.html#cb227-3" tabindex="-1"></a>        <span class="at">horizontal =</span> T,</span>
<span id="cb227-4"><a href="day-5.html#cb227-4" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb227-5"><a href="day-5.html#cb227-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="fl">4.3</span>,<span class="fl">4.6</span>,<span class="fl">4.9</span>,<span class="fl">5.7</span>), <span class="co"># vertical quantile lines</span></span>
<span id="cb227-6"><a href="day-5.html#cb227-6" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb227-7"><a href="day-5.html#cb227-7" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb227-8"><a href="day-5.html#cb227-8" tabindex="-1"></a>       <span class="co"># color palette</span></span>
<span id="cb227-9"><a href="day-5.html#cb227-9" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#FED976&quot;</span>,<span class="st">&quot;#FEB24C&quot;</span>,<span class="st">&quot;#FD8D3C&quot;</span>,<span class="st">&quot;#E31A1C&quot;</span>,<span class="st">&quot;#800026&quot;</span>))</span>
<span id="cb227-10"><a href="day-5.html#cb227-10" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="fl">4.1</span>,<span class="fl">4.24</span>,<span class="fl">4.5</span>,<span class="fl">4.82</span>,<span class="fl">5.5</span>), <span class="co"># x position</span></span>
<span id="cb227-11"><a href="day-5.html#cb227-11" tabindex="-1"></a>     <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">1.15</span>,<span class="fl">0.9</span>,<span class="fl">1.15</span>,<span class="fl">0.9</span>), <span class="co"># y position</span></span>
<span id="cb227-12"><a href="day-5.html#cb227-12" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">&quot;Min&quot;</span>,<span class="st">&quot;Q1&quot;</span>,<span class="st">&quot;Med&quot;</span>,<span class="st">&quot;Q3&quot;</span>,<span class="st">&quot;Max&quot;</span>), <span class="co"># quantile labels</span></span>
<span id="cb227-13"><a href="day-5.html#cb227-13" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#FED976&quot;</span>,<span class="st">&quot;#FEB24C&quot;</span>,<span class="st">&quot;#FD8D3C&quot;</span>,<span class="st">&quot;#E31A1C&quot;</span>,<span class="st">&quot;#800026&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<ul>
<li><span class="math inline">\(z\)</span>-scores</li>
</ul>
<p><span class="math display">\[
z = \frac{x - \bar{x}}{s}
\]</span></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="day-5.html#cb228-1" tabindex="-1"></a><span class="co"># transform the entire dataset into z-scores</span></span>
<span id="cb228-2"><a href="day-5.html#cb228-2" tabindex="-1"></a>z <span class="ot">=</span> (quakes<span class="sc">$</span>mag <span class="sc">-</span> <span class="fu">mean</span>(quakes<span class="sc">$</span>mag))<span class="sc">/</span><span class="fu">sd</span>(quakes<span class="sc">$</span>mag)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<ul>
<li>Normal distributions</li>
</ul>
<p><span class="math display">\[
X \sim N(\mu,\sigma^2)
\qquad\qquad
\frac{X - \mu}{\sigma} = Z \sim N(0,1)
\]</span></p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="day-5.html#cb229-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">4.5</span>,<span class="fl">4.5</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb229-2"><a href="day-5.html#cb229-2" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), <span class="co"># standard normal density</span></span>
<span id="cb229-3"><a href="day-5.html#cb229-3" tabindex="-1"></a>      <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="co"># x axis limits</span></span>
<span id="cb229-4"><a href="day-5.html#cb229-4" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb229-5"><a href="day-5.html#cb229-5" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb229-6"><a href="day-5.html#cb229-6" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;P(X=x)&quot;</span>) <span class="co"># y axis label</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="day-5.html#cb230-1" tabindex="-1"></a><span class="co"># z score for a 5.5 magnitude earthquake</span></span>
<span id="cb230-2"><a href="day-5.html#cb230-2" tabindex="-1"></a>z_score <span class="ot">=</span> (<span class="fl">5.5</span> <span class="sc">-</span> <span class="fu">mean</span>(quakes<span class="sc">$</span>mag))<span class="sc">/</span><span class="fu">sd</span>(quakes<span class="sc">$</span>mag)</span>
<span id="cb230-3"><a href="day-5.html#cb230-3" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z_score) <span class="co"># 1 - z probability (same as z-table)</span></span></code></pre></div>
<pre><code>## [1] 0.01448625</code></pre>
<ul>
<li>Scatterplots</li>
</ul>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="day-5.html#cb232-1" tabindex="-1"></a><span class="co"># base R scatterplot</span></span>
<span id="cb232-2"><a href="day-5.html#cb232-2" tabindex="-1"></a><span class="fu">plot</span>(quakes<span class="sc">$</span>stations,quakes<span class="sc">$</span>mag, <span class="co"># x then y </span></span>
<span id="cb232-3"><a href="day-5.html#cb232-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Number of stations reporting&quot;</span>, <span class="co"># x axis label</span></span>
<span id="cb232-4"><a href="day-5.html#cb232-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Magnitude&quot;</span>, <span class="co"># y axis label</span></span>
<span id="cb232-5"><a href="day-5.html#cb232-5" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Earthquakes off Fiji&quot;</span>, <span class="co"># title</span></span>
<span id="cb232-6"><a href="day-5.html#cb232-6" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="co"># point shape</span></span>
<span id="cb232-7"><a href="day-5.html#cb232-7" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#00000080&quot;</span>) <span class="co"># point color</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<ul>
<li>Least squares regression</li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon_i
\]</span></p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="day-5.html#cb233-1" tabindex="-1"></a><span class="co"># predictor</span></span>
<span id="cb233-2"><a href="day-5.html#cb233-2" tabindex="-1"></a>x <span class="ot">=</span> quakes<span class="sc">$</span>stations</span>
<span id="cb233-3"><a href="day-5.html#cb233-3" tabindex="-1"></a></span>
<span id="cb233-4"><a href="day-5.html#cb233-4" tabindex="-1"></a><span class="co"># response</span></span>
<span id="cb233-5"><a href="day-5.html#cb233-5" tabindex="-1"></a>y <span class="ot">=</span> quakes<span class="sc">$</span>mag</span>
<span id="cb233-6"><a href="day-5.html#cb233-6" tabindex="-1"></a></span>
<span id="cb233-7"><a href="day-5.html#cb233-7" tabindex="-1"></a><span class="co"># base R linear model</span></span>
<span id="cb233-8"><a href="day-5.html#cb233-8" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb233-9"><a href="day-5.html#cb233-9" tabindex="-1"></a><span class="fu">coef</span>(m) <span class="co"># coefficients</span></span></code></pre></div>
<pre><code>## (Intercept)           x 
##  4.09726756  0.01565421</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="day-5.html#cb235-1" tabindex="-1"></a><span class="fu">plot</span>(quakes<span class="sc">$</span>stations,quakes<span class="sc">$</span>mag,</span>
<span id="cb235-2"><a href="day-5.html#cb235-2" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Number of stations reporting&quot;</span>,</span>
<span id="cb235-3"><a href="day-5.html#cb235-3" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Magnitude&quot;</span>,</span>
<span id="cb235-4"><a href="day-5.html#cb235-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Earthquakes off Fiji&quot;</span>,</span>
<span id="cb235-5"><a href="day-5.html#cb235-5" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb235-6"><a href="day-5.html#cb235-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#00000080&quot;</span>)</span>
<span id="cb235-7"><a href="day-5.html#cb235-7" tabindex="-1"></a><span class="co"># add regression line</span></span>
<span id="cb235-8"><a href="day-5.html#cb235-8" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(quakes<span class="sc">$</span>stations),<span class="fu">sort</span>(m<span class="sc">$</span>fitted.values),</span>
<span id="cb235-9"><a href="day-5.html#cb235-9" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb235-10"><a href="day-5.html#cb235-10" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;gold&quot;</span>) <span class="co"># line color</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<ul>
<li>Confidence intervals</li>
</ul>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="day-5.html#cb236-1" tabindex="-1"></a><span class="co"># 95% confidence interval</span></span>
<span id="cb236-2"><a href="day-5.html#cb236-2" tabindex="-1"></a></span>
<span id="cb236-3"><a href="day-5.html#cb236-3" tabindex="-1"></a><span class="co"># mean magnitude</span></span>
<span id="cb236-4"><a href="day-5.html#cb236-4" tabindex="-1"></a>xbar_mag <span class="ot">=</span> <span class="fu">mean</span>(quakes<span class="sc">$</span>mag)</span>
<span id="cb236-5"><a href="day-5.html#cb236-5" tabindex="-1"></a><span class="co"># standard deviation of magnitude</span></span>
<span id="cb236-6"><a href="day-5.html#cb236-6" tabindex="-1"></a>s_mag <span class="ot">=</span> <span class="fu">sd</span>(quakes<span class="sc">$</span>mag)</span>
<span id="cb236-7"><a href="day-5.html#cb236-7" tabindex="-1"></a><span class="co"># sample size</span></span>
<span id="cb236-8"><a href="day-5.html#cb236-8" tabindex="-1"></a>n_mag <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">nrow</span>(quakes))</span>
<span id="cb236-9"><a href="day-5.html#cb236-9" tabindex="-1"></a><span class="co"># margin of error</span></span>
<span id="cb236-10"><a href="day-5.html#cb236-10" tabindex="-1"></a>moe_mag <span class="ot">=</span> <span class="fl">1.96</span><span class="sc">*</span>(s_mag<span class="sc">/</span><span class="fu">sqrt</span>(n_mag))</span>
<span id="cb236-11"><a href="day-5.html#cb236-11" tabindex="-1"></a></span>
<span id="cb236-12"><a href="day-5.html#cb236-12" tabindex="-1"></a>xbar_mag <span class="sc">-</span> moe_mag <span class="co"># lower bound</span></span></code></pre></div>
<pre><code>## [1] 4.595436</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="day-5.html#cb238-1" tabindex="-1"></a>xbar_mag <span class="co"># point estimate</span></span></code></pre></div>
<pre><code>## [1] 4.6204</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="day-5.html#cb240-1" tabindex="-1"></a>xbar_mag <span class="sc">+</span> moe_mag <span class="co"># upper bound</span></span></code></pre></div>
<pre><code>## [1] 4.645364</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<ul>
<li>Hypothesis tests</li>
</ul>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="day-5.html#cb242-1" tabindex="-1"></a><span class="co"># schizophrenic reaction time data</span></span>
<span id="cb242-2"><a href="day-5.html#cb242-2" tabindex="-1"></a>schiz <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">scan</span>(<span class="st">&quot;data/schiz.txt&quot;</span>,<span class="at">skip=</span><span class="dv">5</span>),</span>
<span id="cb242-3"><a href="day-5.html#cb242-3" tabindex="-1"></a>                   <span class="at">schizophrenia =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;no&quot;</span>,<span class="dv">30</span><span class="sc">*</span><span class="dv">11</span>),<span class="fu">rep</span>(<span class="st">&quot;yes&quot;</span>,<span class="dv">30</span><span class="sc">*</span><span class="dv">6</span>)))</span>
<span id="cb242-4"><a href="day-5.html#cb242-4" tabindex="-1"></a></span>
<span id="cb242-5"><a href="day-5.html#cb242-5" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># R data wrangling package</span></span>
<span id="cb242-6"><a href="day-5.html#cb242-6" tabindex="-1"></a>sstats <span class="ot">=</span> schiz <span class="sc">%&gt;%</span> </span>
<span id="cb242-7"><a href="day-5.html#cb242-7" tabindex="-1"></a>  <span class="co"># group by yes/no schiz</span></span>
<span id="cb242-8"><a href="day-5.html#cb242-8" tabindex="-1"></a>  <span class="fu">group_by</span>(schizophrenia) <span class="sc">%&gt;%</span> </span>
<span id="cb242-9"><a href="day-5.html#cb242-9" tabindex="-1"></a>  <span class="co"># mean/var/sample size for yes/no strata</span></span>
<span id="cb242-10"><a href="day-5.html#cb242-10" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">xbar =</span> <span class="fu">mean</span>(time),</span>
<span id="cb242-11"><a href="day-5.html#cb242-11" tabindex="-1"></a>            <span class="at">s2 =</span> <span class="fu">var</span>(time),</span>
<span id="cb242-12"><a href="day-5.html#cb242-12" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb242-13"><a href="day-5.html#cb242-13" tabindex="-1"></a><span class="co"># print dataframe</span></span>
<span id="cb242-14"><a href="day-5.html#cb242-14" tabindex="-1"></a>sstats</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   schizophrenia  xbar     s2     n
##   &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
## 1 no             310.  4209.   330
## 2 yes            507. 69089.   180</code></pre>
<p><span class="math display">\[
\begin{aligned}
\text{H}_0: \mu_1 - \mu_2 = 0 \\
\\
\text{H}_a: \mu_1 - \mu_2 &lt; 0
\end{aligned}
\]</span></p>
<p><br></p>
<p><span class="math display">\[
t^* = \frac{(\bar{x}_1 - \bar{x}_2) + (\mu_1 - \mu_2)}{\sqrt{(s_1^2/n_1) + (s_2^2/n_2)}}
\]</span></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="day-5.html#cb244-1" tabindex="-1"></a><span class="co"># test statistics for independent difference in means</span></span>
<span id="cb244-2"><a href="day-5.html#cb244-2" tabindex="-1"></a>tstar <span class="ot">=</span> <span class="fu">as.numeric</span>((sstats[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">-</span> sstats[<span class="dv">2</span>,<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb244-3"><a href="day-5.html#cb244-3" tabindex="-1"></a>                     <span class="fu">sqrt</span>((sstats[<span class="dv">1</span>,<span class="dv">3</span>]<span class="sc">/</span>sstats[<span class="dv">1</span>,<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb244-4"><a href="day-5.html#cb244-4" tabindex="-1"></a>                            (sstats[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">/</span>sstats[<span class="dv">2</span>,<span class="dv">4</span>])))</span>
<span id="cb244-5"><a href="day-5.html#cb244-5" tabindex="-1"></a>tstar</span></code></pre></div>
<pre><code>## [1] -9.877136</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="day-5.html#cb246-1" tabindex="-1"></a><span class="co"># p-vale for t-pivot test statistic</span></span>
<span id="cb246-2"><a href="day-5.html#cb246-2" tabindex="-1"></a><span class="fu">pt</span>(tstar,<span class="fu">min</span>(sstats[,<span class="dv">4</span>])<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 6.114281e-19</code></pre>
<p><br></p>
<ul>
<li>Discrete expected value</li>
</ul>
<p><span class="math display">\[
\mathbb{E}X = \sum_x x P(X=x)
\]</span></p>
<ul>
<li><p>Binomial distribution</p>
<ul>
<li><p>Discrete, binary processes</p></li>
<li><p>Success/failure</p></li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Bin}(n,p)
\qquad \qquad
\mathbb{E}X = np
\qquad \qquad
\mathbb{V}X = np(1-p)
\]</span></p>
<ul>
<li><p>Poisson distribution</p>
<ul>
<li>Positive discrete counts</li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Pois}(\lambda)
\qquad \qquad
\mathbb{E}X = \mathbb{V}X = \lambda
\]</span></p>
<ul>
<li><p>Geometric distribution</p>
<ul>
<li>Number of trials to reach success</li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Geom}(p)
\qquad \qquad
\mathbb{E}X = 1/p
\]</span></p>
<ul>
<li><p>Hypergeometric distribution</p>
<ul>
<li><p>Geometric distribution</p></li>
<li><p>Sampling without replacement</p></li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Hyper}(N,K,n)
\qquad \qquad
\mathbb{E}X = n \frac{K}{N}
\]</span></p>
<p><br></p>
<ul>
<li>Continuous expected values</li>
</ul>
<p><span class="math display">\[
\mathbb{E}X = \int_{\chi}x f_x(x)
\]</span></p>
<ul>
<li><p>Gamma distribution</p>
<ul>
<li>Positive continuous values</li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Gamma}(\alpha,\theta)
\qquad \qquad
\mathbb{E}X = \alpha \theta
\qquad \qquad
\mathbb{V}X = \alpha \theta^2
\]</span></p>
<ul>
<li><p>Beta distribution</p>
<ul>
<li>Proportions/probabilities</li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Beta}(\alpha,\beta)
\qquad \qquad
\mathbb{E}X = \frac{\alpha}{\alpha + \beta}
\qquad \qquad
\mathbb{V}X = \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}
\]</span></p>
<ul>
<li><p>Uniform distribution</p>
<ul>
<li><p>Equi-probable events</p></li>
<li><p>Defined boundaries (a and b)</p></li>
</ul></li>
</ul>
<p><span class="math display">\[
X \sim \text{Unif}(a,b)
\qquad \qquad
\mathbb{E}X = \frac{1}{2}(b-a)
\qquad \qquad
\mathbb{V}X = \frac{1}{12}(b-a)^2
\]</span></p>
<p><br></p>
<p><strong>Any questions?</strong></p>
<p><br></p>
</div>
<div id="statistical-modeling" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Statistical Modeling<a href="day-5.html#statistical-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>What is a model?</p>
<ul>
<li><p>Scientific vs. Thought vs. Mathematical</p></li>
<li><p>Statistical?</p></li>
</ul></li>
<li><p>Why do we use models?</p></li>
</ul>
<p><br></p>
<ul>
<li><p>Trend analysis</p>
<ul>
<li>What’s happening with total kjeldahl nitrogen in Kansas?</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="day-5.html#cb248-1" tabindex="-1"></a><span class="fu">plot</span>(kslr_tkn<span class="sc">$</span>Year, kslr_tkn<span class="sc">$</span>UOM, </span>
<span id="cb248-2"><a href="day-5.html#cb248-2" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;#00000060&quot;</span>,</span>
<span id="cb248-3"><a href="day-5.html#cb248-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb248-4"><a href="day-5.html#cb248-4" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;TKN (mg/L)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Simple linear regression</li>
</ul>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 t_i + \epsilon_i
\]</span></p>
<p><span class="math display">\[
\epsilon_i \sim N(0, \sigma^2 \textbf{I})
\]</span></p>
<p><br></p>
<ul>
<li>Another way to write it:</li>
</ul>
<p><span class="math display">\[
y_i \sim N(\mu,\sigma^2 \textbf{I})
\]</span></p>
<p><span class="math display">\[
\mu = \beta_0 + \beta_1 t_i
\]</span></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="day-5.html#cb249-1" tabindex="-1"></a>mod_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">UOM =</span> kslr_tkn<span class="sc">$</span>UOM,</span>
<span id="cb249-2"><a href="day-5.html#cb249-2" tabindex="-1"></a>                    <span class="at">Year =</span> kslr_tkn<span class="sc">$</span>Year,</span>
<span id="cb249-3"><a href="day-5.html#cb249-3" tabindex="-1"></a>                    <span class="at">huc08 =</span> kslr_tkn<span class="sc">$</span>huc08)</span>
<span id="cb249-4"><a href="day-5.html#cb249-4" tabindex="-1"></a></span>
<span id="cb249-5"><a href="day-5.html#cb249-5" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">lm</span>(UOM <span class="sc">~</span> Year, <span class="at">data =</span> mod_df)</span>
<span id="cb249-6"><a href="day-5.html#cb249-6" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = UOM ~ Year, data = mod_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.1020 -0.4490 -0.2046  0.1621 12.0753 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 44.898799   3.430303   13.09   &lt;2e-16 ***
## Year        -0.021873   0.001706  -12.82   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8546 on 4761 degrees of freedom
## Multiple R-squared:  0.03338,    Adjusted R-squared:  0.03318 
## F-statistic: 164.4 on 1 and 4761 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="day-5.html#cb251-1" tabindex="-1"></a>or <span class="ot">=</span> <span class="fu">order</span>(mod_df<span class="sc">$</span>Year)</span>
<span id="cb251-2"><a href="day-5.html#cb251-2" tabindex="-1"></a><span class="fu">plot</span>(mod_df<span class="sc">$</span>Year, mod_df<span class="sc">$</span>UOM, </span>
<span id="cb251-3"><a href="day-5.html#cb251-3" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;#D1D1D180&quot;</span>,</span>
<span id="cb251-4"><a href="day-5.html#cb251-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb251-5"><a href="day-5.html#cb251-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;TKN (mg/L)&quot;</span>)</span>
<span id="cb251-6"><a href="day-5.html#cb251-6" tabindex="-1"></a><span class="fu">lines</span>(mod_df<span class="sc">$</span>Year[or], <span class="fu">predict</span>(m1, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)[or], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;#512885&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br></p>
<ul>
<li><p>What about space?</p>
<ul>
<li>Add a “cluster effect”</li>
</ul></li>
</ul>
<p><span class="math display">\[
y_{ij} = \beta_0 + \beta_1 t_i + \beta_2 s_j \epsilon_{ij}
\]</span></p>
<p><span class="math display">\[
\epsilon_{ij} \sim N(0, \sigma^2 \textbf{I})
\]</span></p>
<ul>
<li><p><span class="math inline">\(s_j\)</span> pertains to the “HUC” levels</p>
<ul>
<li><p>Think of it as a categorical predictor</p></li>
<li><p>Goes to <span class="math inline">\(0\)</span> based on which HUC is present</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="day-5.html#cb252-1" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">lm</span>(UOM <span class="sc">~</span> Year <span class="sc">+</span> <span class="fu">as.factor</span>(huc08), <span class="at">data =</span> mod_df)</span>
<span id="cb252-2"><a href="day-5.html#cb252-2" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = UOM ~ Year + as.factor(huc08), data = mod_df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4040 -0.4201 -0.1632  0.1809 11.8143 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              44.617022   3.305166  13.499  &lt; 2e-16 ***
## Year                     -0.021749   0.001642 -13.242  &lt; 2e-16 ***
## as.factor(huc08)10250017  0.368838   0.072993   5.053 4.51e-07 ***
## as.factor(huc08)10270101 -0.187518   0.075699  -2.477 0.013278 *  
## as.factor(huc08)10270102 -0.201293   0.068389  -2.943 0.003263 ** 
## as.factor(huc08)10270103 -0.214657   0.081542  -2.632 0.008504 ** 
## as.factor(huc08)10270104  0.004271   0.068111   0.063 0.950001    
## as.factor(huc08)10270205  0.430969   0.074249   5.804 6.88e-09 ***
## as.factor(huc08)10270207  0.292476   0.077379   3.780 0.000159 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8216 on 4754 degrees of freedom
## Multiple R-squared:  0.108,  Adjusted R-squared:  0.1065 
## F-statistic: 71.98 on 8 and 4754 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-110-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Where are we headed?</li>
</ul>
<p><br></p>
</div>
<div id="stringing-sentences" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Stringing sentences<a href="day-5.html#stringing-sentences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Correlative inference</p>
<ul>
<li>Which cruise liner should you avoid?</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="day-5.html#cb254-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb254-2"><a href="day-5.html#cb254-2" tabindex="-1"></a><span class="fu">boxplot</span>(cruise<span class="sc">$</span>infected_proportion <span class="sc">~</span> cruise<span class="sc">$</span>liner,</span>
<span id="cb254-3"><a href="day-5.html#cb254-3" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Proportion infected&quot;</span>,</span>
<span id="cb254-4"><a href="day-5.html#cb254-4" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb254-5"><a href="day-5.html#cb254-5" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Norovirus outbreaks on cruise liners&quot;</span>,</span>
<span id="cb254-6"><a href="day-5.html#cb254-6" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb254-7"><a href="day-5.html#cb254-7" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>,</span>
<span id="cb254-8"><a href="day-5.html#cb254-8" tabindex="-1"></a>        <span class="at">cex.axis =</span> <span class="fl">0.7</span>,</span>
<span id="cb254-9"><a href="day-5.html#cb254-9" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;#D1D1D190&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/cruisechunk1-1.png" width="672" /></p>
<p><span class="math display">\[
\left[y|\alpha, \beta \right] \equiv \text{Beta}(\alpha,\beta)
\]</span></p>
<p><span class="math display">\[
\alpha = \mu \phi \qquad \beta = (1 - \mu) \phi \qquad g(\mu) = \textbf{X}^\prime \boldsymbol{\beta}
\]</span></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="day-5.html#cb255-1" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">gam</span>(infected_proportion <span class="sc">~</span> <span class="fu">as.factor</span>(liner) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb255-2"><a href="day-5.html#cb255-2" tabindex="-1"></a>         <span class="at">data =</span> cruise, <span class="at">family =</span> <span class="fu">betar</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/cruisechunk3-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Seems like Fred Olsen is a bad idea…</li>
</ul>
<div style="border:1px solid #ddd; border-radius:8px; margin:1em auto; width:50%; box-shadow:0 2px 5px rgba(0,0,0,0.06); background:white;">
<div style="background:#51288590; color:white; padding:6px 10px; font-weight:600; 
                  border-radius:8px 8px 0 0;">
Frequency distribution of cruise liners
</div>
<div style="padding:6px 10px; font-size:0.9em; color:#555;">
Half of it, that is…
</div>
<div style="padding:8px 10px;">
<table class="table table-condensed table-hover" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Liner
</th>
<th style="text-align:right;">
Frequency
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Aida Cruises
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Azamara Club Cruises
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Carnival Cruise Line
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Celebrity Cruises
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Crystal Cruises
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Cunard Line
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Disney Cruise Line
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Fred Olsen Cruises
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Holland America Line
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
Norwegian Cruise Line
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
</div>
<div id="telling-stories" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Telling stories<a href="day-5.html#telling-stories" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>What just happened?</p></li>
<li><p>Are these results a problem?</p>
<ul>
<li>Is the context behind them bad?</li>
</ul></li>
<li><p>What is data?</p></li>
<li><p>What is a statistic?</p>
<ul>
<li><p>What is it for?</p></li>
<li><p>What are the limitations of statistics? Of science?</p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p>A major step in telling a story</p>
<ul>
<li>Having an idea for the plot</li>
</ul></li>
<li><p>What makes a good plot?</p></li>
</ul>
<p><br></p>
<ul>
<li><p>How do scientific inquiries happen?</p>
<ul>
<li><p>By accident (Grokking)</p></li>
<li><p>By madness (Game theory)</p></li>
<li><p>Taking risks (Chemotherapy)</p></li>
<li><p>Via spite (Scale-free networks)</p></li>
<li><p>“Things breaking” (?)</p></li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><p>Is Fred Olsen a potent vector of norovirus?</p>
<ul>
<li>Are Carnival cruises really that <em>safe</em> of an option?</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="day-5.html#cb256-1" tabindex="-1"></a>bbreg <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb256-2"><a href="day-5.html#cb256-2" tabindex="-1"></a>  </span>
<span id="cb256-3"><a href="day-5.html#cb256-3" tabindex="-1"></a>  <span class="co"># process model</span></span>
<span id="cb256-4"><a href="day-5.html#cb256-4" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb256-5"><a href="day-5.html#cb256-5" tabindex="-1"></a>    y[i] <span class="sc">~</span> <span class="fu">dbeta</span>(alpha[i], beta[i])</span>
<span id="cb256-6"><a href="day-5.html#cb256-6" tabindex="-1"></a>    </span>
<span id="cb256-7"><a href="day-5.html#cb256-7" tabindex="-1"></a>    <span class="co"># mean/precision parameterization</span></span>
<span id="cb256-8"><a href="day-5.html#cb256-8" tabindex="-1"></a>    alpha[i] <span class="ot">&lt;-</span> mu[i] <span class="sc">*</span> phi</span>
<span id="cb256-9"><a href="day-5.html#cb256-9" tabindex="-1"></a>    beta[i]  <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>mu[i]) <span class="sc">*</span> phi</span>
<span id="cb256-10"><a href="day-5.html#cb256-10" tabindex="-1"></a>    </span>
<span id="cb256-11"><a href="day-5.html#cb256-11" tabindex="-1"></a>    <span class="co"># logit link function</span></span>
<span id="cb256-12"><a href="day-5.html#cb256-12" tabindex="-1"></a>    <span class="fu">logit</span>(mu[i]) <span class="ot">&lt;-</span> a <span class="sc">+</span> b<span class="sc">*</span>x[i]</span>
<span id="cb256-13"><a href="day-5.html#cb256-13" tabindex="-1"></a>  }</span>
<span id="cb256-14"><a href="day-5.html#cb256-14" tabindex="-1"></a>  </span>
<span id="cb256-15"><a href="day-5.html#cb256-15" tabindex="-1"></a>  <span class="co"># priors</span></span>
<span id="cb256-16"><a href="day-5.html#cb256-16" tabindex="-1"></a>  phi <span class="sc">~</span> <span class="fu">dgamma</span>(<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb256-17"><a href="day-5.html#cb256-17" tabindex="-1"></a>  a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">1</span>)</span>
<span id="cb256-18"><a href="day-5.html#cb256-18" tabindex="-1"></a>  b <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,.<span class="dv">1</span>)</span>
<span id="cb256-19"><a href="day-5.html#cb256-19" tabindex="-1"></a>  </span>
<span id="cb256-20"><a href="day-5.html#cb256-20" tabindex="-1"></a>}</span>
<span id="cb256-21"><a href="day-5.html#cb256-21" tabindex="-1"></a></span>
<span id="cb256-22"><a href="day-5.html#cb256-22" tabindex="-1"></a><span class="co"># setting up jags data</span></span>
<span id="cb256-23"><a href="day-5.html#cb256-23" tabindex="-1"></a>jags_dat <span class="ot">=</span> <span class="fu">list</span>(<span class="at">y =</span> cruise<span class="sc">$</span>infected_proportion,</span>
<span id="cb256-24"><a href="day-5.html#cb256-24" tabindex="-1"></a>                <span class="at">x =</span> <span class="fu">as.integer</span>(<span class="fu">factor</span>(cruise<span class="sc">$</span>liner)),</span>
<span id="cb256-25"><a href="day-5.html#cb256-25" tabindex="-1"></a>                <span class="at">n =</span> <span class="fu">nrow</span>(cruise))</span>
<span id="cb256-26"><a href="day-5.html#cb256-26" tabindex="-1"></a></span>
<span id="cb256-27"><a href="day-5.html#cb256-27" tabindex="-1"></a><span class="co"># initial proposal values</span></span>
<span id="cb256-28"><a href="day-5.html#cb256-28" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">list</span>(<span class="at">a =</span> .<span class="dv">01</span>, <span class="at">b =</span> .<span class="dv">01</span>, <span class="at">phi =</span> <span class="dv">1</span>)</span>
<span id="cb256-29"><a href="day-5.html#cb256-29" tabindex="-1"></a></span>
<span id="cb256-30"><a href="day-5.html#cb256-30" tabindex="-1"></a><span class="co"># fitting the model</span></span>
<span id="cb256-31"><a href="day-5.html#cb256-31" tabindex="-1"></a>bbreg_mcmc <span class="ot">=</span> <span class="fu">jags.fit</span>(jags_dat,<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;phi&quot;</span>),</span>
<span id="cb256-32"><a href="day-5.html#cb256-32" tabindex="-1"></a>                      bbreg,inits,<span class="at">n.adapt=</span><span class="dv">5000</span>,</span>
<span id="cb256-33"><a href="day-5.html#cb256-33" tabindex="-1"></a>                      <span class="at">n.update=</span><span class="dv">5000</span>,<span class="at">n.iter=</span><span class="dv">100000</span>,</span>
<span id="cb256-34"><a href="day-5.html#cb256-34" tabindex="-1"></a>                      <span class="at">thin=</span><span class="dv">1</span>,<span class="at">n.chains=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="day-5.html#cb257-1" tabindex="-1"></a><span class="co"># reproducibility seed</span></span>
<span id="cb257-2"><a href="day-5.html#cb257-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">73</span>)</span>
<span id="cb257-3"><a href="day-5.html#cb257-3" tabindex="-1"></a></span>
<span id="cb257-4"><a href="day-5.html#cb257-4" tabindex="-1"></a><span class="co"># number of posterior samples</span></span>
<span id="cb257-5"><a href="day-5.html#cb257-5" tabindex="-1"></a>K <span class="ot">=</span> <span class="fu">nrow</span>(samp)</span>
<span id="cb257-6"><a href="day-5.html#cb257-6" tabindex="-1"></a></span>
<span id="cb257-7"><a href="day-5.html#cb257-7" tabindex="-1"></a><span class="co"># set to carnival and fred olsen</span></span>
<span id="cb257-8"><a href="day-5.html#cb257-8" tabindex="-1"></a>x_pred <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">8</span>)</span>
<span id="cb257-9"><a href="day-5.html#cb257-9" tabindex="-1"></a>a_post <span class="ot">=</span> samp[,<span class="dv">1</span>] <span class="co"># intercept post</span></span>
<span id="cb257-10"><a href="day-5.html#cb257-10" tabindex="-1"></a>b_post <span class="ot">=</span> samp[,<span class="dv">2</span>] <span class="co"># effect par post</span></span>
<span id="cb257-11"><a href="day-5.html#cb257-11" tabindex="-1"></a>phi_post <span class="ot">=</span> samp[,<span class="dv">3</span>] <span class="co"># precision par post</span></span>
<span id="cb257-12"><a href="day-5.html#cb257-12" tabindex="-1"></a></span>
<span id="cb257-13"><a href="day-5.html#cb257-13" tabindex="-1"></a><span class="co"># vectorized posterior logit(mu) predictions</span></span>
<span id="cb257-14"><a href="day-5.html#cb257-14" tabindex="-1"></a>eta_post <span class="ot">=</span> <span class="fu">outer</span>(a_post, x_pred,</span>
<span id="cb257-15"><a href="day-5.html#cb257-15" tabindex="-1"></a>                 <span class="at">FUN =</span> <span class="cf">function</span>(ai, x) ai) <span class="sc">+</span> </span>
<span id="cb257-16"><a href="day-5.html#cb257-16" tabindex="-1"></a>  <span class="fu">outer</span>(b_post, x_pred)</span>
<span id="cb257-17"><a href="day-5.html#cb257-17" tabindex="-1"></a></span>
<span id="cb257-18"><a href="day-5.html#cb257-18" tabindex="-1"></a><span class="co"># &quot;un-do&quot; the link function</span></span>
<span id="cb257-19"><a href="day-5.html#cb257-19" tabindex="-1"></a>mu_post <span class="ot">=</span> <span class="fu">invlogit</span>(eta_post)</span>
<span id="cb257-20"><a href="day-5.html#cb257-20" tabindex="-1"></a></span>
<span id="cb257-21"><a href="day-5.html#cb257-21" tabindex="-1"></a><span class="co"># alpha posterior predictions</span></span>
<span id="cb257-22"><a href="day-5.html#cb257-22" tabindex="-1"></a>alpha_post <span class="ot">=</span> mu_post <span class="sc">*</span> phi_post</span>
<span id="cb257-23"><a href="day-5.html#cb257-23" tabindex="-1"></a></span>
<span id="cb257-24"><a href="day-5.html#cb257-24" tabindex="-1"></a><span class="co"># beta posterior predictions</span></span>
<span id="cb257-25"><a href="day-5.html#cb257-25" tabindex="-1"></a>beta_post <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> mu_post) <span class="sc">*</span> phi_post</span>
<span id="cb257-26"><a href="day-5.html#cb257-26" tabindex="-1"></a></span>
<span id="cb257-27"><a href="day-5.html#cb257-27" tabindex="-1"></a><span class="co"># posterior predictions of y</span></span>
<span id="cb257-28"><a href="day-5.html#cb257-28" tabindex="-1"></a>y_post <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rbeta</span>(<span class="fu">length</span>(alpha_post),</span>
<span id="cb257-29"><a href="day-5.html#cb257-29" tabindex="-1"></a>                      alpha_post, beta_post),</span>
<span id="cb257-30"><a href="day-5.html#cb257-30" tabindex="-1"></a>                <span class="at">nrow =</span> K, <span class="at">ncol =</span> <span class="fu">length</span>(x_pred))</span></code></pre></div>
<p><img src="_main_files/figure-html/cruisechunk7-1.png" width="672" style="display: block; margin: auto;" /><img src="_main_files/figure-html/cruisechunk7-2.png" width="672" style="display: block; margin: auto;" /></p>
<p><img src="_main_files/figure-html/cruisechunk8-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li><p>Supplemental material</p>
<ul>
<li><p>Project proposal samples</p></li>
<li><p>STAT 341 dictionary</p></li>
<li><p>Varying R resources</p></li>
</ul></li>
<li><p>Extra reading</p>
<ul>
<li><p>R for Data Science</p></li>
<li><p>Linear Models in R</p></li>
</ul></li>
<li><p>Assignment 2</p></li>
</ul>
<p><br></p>
</div>
<div id="go-away-4" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Go away<a href="day-5.html#go-away-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-model1.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
